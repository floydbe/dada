#include <stdio.h>
#include <stdlib.h>

int main(int argc, char *argv[]) {
	if (argc != 3) {
		printf("Supply two file names as arguments.\n");
		return 1;
	}
	FILE *f, *g;
	f = fopen(argv[1], "rb");
	g = fopen(argv[2], "wb");
	if (f==NULL || g==NULL) {
		printf("Error opening files.\n");
	}
	else {
		unsigned int a;
		unsigned int i = 0;
		unsigned char jump1[6] = {0xe8, 0x39, 0x00, 0x00, 0x00, 0xc3};
		unsigned char attack[17] = {0x68, 0x63, 0x85, 0x04, 0x08, 0xe8, 0x65, 0xfd, 0xff, 0xff, 0x5a, 0xe8, 0x6e, 0x00, 0x00, 0x00, 0xc3};
		unsigned char string[26] = {0x43, 0x61, 0x76, 0x6d, 0x61, 0x6e, 0x20, 0x76, 0x69, 0x72, 0x75, 0x73, 0x20, 0x61, 0x63, 0x74, 0x69, 0x76, 0x61, 0x74, 0x69, 0x6e, 0x67, 0x21, 0x00, 0x90};
		while ((a = fgetc(f)) != EOF) {
			if (i > 0x400+0x142 && i <= 0x400+0x142+6) {
				printf("%d | %hx\n", i, jump1[i-(0x400+0x142+1)]);
				fputc(jump1[i-(0x400+0x142+1)], g);
			}
			else if (i > 0x400+0x142+0x20 && i <= 0x400+0x142+0x20+26) {
				printf("%d || %hx\n", i, string[i-(0x400+0x142+0x20+1)]);
				fputc(string[i-(0x400+0x142+0x20+1)], g);
			}
			else if (i > 0x400+0x142+0x20+26+4 && i <= 0x400+0x142+0x20+26+4+17) {
				printf("%d ||| %hx\n", i, attack[i-(0x400+0x142+0x20+26+4+1)]);
				fputc(attack[i-(0x400+0x142+0x20+26+4+1)], g);
			}
			else {
				fputc(a,g);
			}
			i++;
		}
	}
	fclose(f);
	fclose(g);
	return 0;
}
